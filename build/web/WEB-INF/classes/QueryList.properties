
LOAD_CIRCLE_CODE=HP,PB
#Queries

CUR_DAY_STATUS_QRY = SELECT  count(1) tot_cnt, SUM(DECODE(ACTIVATION_STATUS, 'C' , 1, 0)) SUCCESS_CNT, SUM(DECODE(ACTIVATION_STATUS, 'R' , 1, 0)) REJ_CNT, SUM(DECODE(ACTIVATION_STATUS, 'N',1, 'AF', 1, 'TC' , 1, 'AR', 1, 'ER', 1)) PEN_CNT from (SELECT TO_CHAR(DATEALLOTTMENT,'DD-MON-YYYY') DATE_,CIRCLE_CODE,ACTIVATION_STATUS, NVL(STDPCO, DE_CSCCODE) STDPCO,DE_CSCCODE, REMARKS FROM @@DBSCHEMA@@.CUST_DATA_EKYC_SWAP A WHERE TRUNC(DATEALLOTTMENT) = TRUNC(SYSDATE))  WHERE (STDPCO = ? or DE_CSCCODE= ?)
BAR_GRAPH_QRY = SELECT SUM(DECODE(ACTIVATION_STATUS, 'C' , 1, 0)) SUCCESS_COUNT, SUM(DECODE(ACTIVATION_STATUS, 'N',1, 'AF', 1, 'TC' , 1, 'AR', 1, 'ER', 1)) PENDING_COUNT,   SUM(DECODE(ACTIVATION_STATUS, 'R' , 1, 0)) REJECTED_COUNT   FROM   (SELECT TO_CHAR(DATEALLOTTMENT,'DD-MON-YYYY') DATE_,     CIRCLE_CODE,     ACTIVATION_STATUS,     NVL(STDPCO, DE_CSCCODE) STDPCO,DE_CSCCODE,    REMARKS   FROM @@DBSCHEMA@@.CUST_DATA_EKYC_SWAP A   WHERE TRUNC(DATEALLOTTMENT) BETWEEN to_date(?) AND to_date(?)) WHERE (STDPCO = ? or DE_CSCCODE = ?)
PIE_GRAPH_QRY = SELECT SUM(DECODE(REMARKS,'EKYC-NORMAL', 1,0)) NORMAL, SUM(DECODE(REMARKS,'EKYC-MNP', 1,0)) MNP, SUM(DECODE(REMARKS,'EKYC-CYMN', 1,0)) CYMN, SUM(DECODE(REMARKS,'EKYC-SIMSWAP', 1,0)) SIM_REPLACEMENT from (SELECT TO_CHAR(DATEALLOTTMENT,'DD-MON-YYYY') DATE_,CIRCLE_CODE,ACTIVATION_STATUS, NVL(STDPCO, DE_CSCCODE) STDPCO,DE_CSCCODE, REMARKS FROM @@DBSCHEMA@@.CUST_DATA_EKYC_SWAP A WHERE TRUNC(DATEALLOTTMENT) between to_date(?) and to_date(?) ) WHERE (STDPCO = ? or DE_CSCCODE = ?)

#FMS DASHBOARD QUERIES
FMS_CUR_DAY_STATUS_QRY = select NVL(sum(   case when  remarks = 'SUCCESS' and zone in ('NZ','WZ') then 1 when  remarks = 'Order is created successfully' and zone in ('SZ','EZ') then 1 else 0 END), 0) SUCCESS_COUNT, NVL(SUM(CASE WHEN remarks IS NULL THEN 1 ELSE 0   END ) , 0 ) PENDING_COUNT, NVL(SUM(CASE WHEN remarks NOT IN ('SUCCESS', 'Order is created successfully' )  THEN 1 ELSE 0   END ), 0) REJECTED_COUNT, COUNT(1) TOT_COUNT from @@DBSCHEMA@@.uniserve_caf_ca_ba WHERE ORD_SALES_FRANCHISEE_CODE = ? AND TRUNC(CREATED_DATE) = SYSDATE
FMS_BAR_GRAPH_QRY = select NVL(sum(   case when  remarks = 'SUCCESS' and zone in ('NZ','WZ') then 1 when  remarks = 'Order is created successfully' and zone in ('SZ','EZ') then 1 else 0 END), 0) SUCCESS_COUNT, NVL(SUM(CASE WHEN remarks IS NULL THEN 1 ELSE 0   END ) , 0 ) PENDING_COUNT, NVL(SUM(CASE WHEN remarks NOT IN ('SUCCESS', 'Order is created successfully' )  THEN 1 ELSE 0   END ), 0) REJECTED_COUNT from @@DBSCHEMA@@.uniserve_caf_ca_ba WHERE ORD_SALES_FRANCHISEE_CODE = ? AND TRUNC(CREATED_DATE) BETWEEN  to_date(?) AND to_date(?)
FMS_PIE_GRAPH_QRY = select NVL(SUM(DECODE(SERVICE_TYPE, 'FTTH BroadBand', 1, 0)), 0) FTTH_BroadBand_COUNT, NVL(SUM(DECODE(SERVICE_TYPE, 'FTTH Voice', 1, 0)), 0) FTTH_Voice_COUNT , NVL(SUM(DECODE(UPPER(SERVICE_TYPE), 'LANDLINE', 1, 0)), 0) LANDLINE_COUNT , NVL(SUM(DECODE(UPPER(SERVICE_TYPE), 'FTTH BB', 1, 0)), 0) FTTH_BB_COUNT from @@DBSCHEMA@@.uniserve_caf_ca_ba WHERE ORD_SALES_FRANCHISEE_CODE = ? AND TRUNC(CREATED_DATE) BETWEEN  to_date(?) AND to_date(?)

FMS_CAF_SEQ_NO = SELECT @@DBSCHEMA@@.FMS_CAF_SEQ_NO.NEXTVAL ID FROM DUAL

WL_CAF_SEQ_NO = SELECT @@DBSCHEMA@@.WL_CAF_SEQ_NO.NEXTVAL ID FROM DUAL
FMS_DATA_WEB_PORTAL = INSERT INTO @@DBSCHEMA@@.FMS_DATA_WEB_PORTAL (CAF_NO, CUST_MOBILE_NO, CIRCLE_CODE, ZONE_CODE, CUST_TITLE, FIRST_NAME, CUST_LAST_NAME, F_H_NAME, GENDER, DOB, CUST_USAGE_TYPE,EMAIL, REQ_DATA) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)
WINGS_PAYMENT_AUDIT = INSERT INTO @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT (CAF_NO, SESSIONID, BNK_TXN_ID, AMOUNT, SERVICE_NAME, PORTAL_TXN_ID, VENDOR_TXN_ID, TXN_STATUS, ERROR_CODE, ERROR_MSG, PAYMENT_TIME, MOBILE_NO,TARIFF_PLAN_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)
UPDATE_WINGS_PAYMENT_AUDIT = UPDATE @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT SET BNK_TXN_ID =?,   AMOUNT       =?,   SERVICE_NAME =?,   PORTAL_TXN_ID=?,   VENDOR_TXN_ID=?,   TXN_STATUS   =?,   ERROR_CODE   =?,   ERROR_MSG    =?,   PAYMENT_TIME =?,   BANK_NAME  =? WHERE SESSIONID=?

#-uidAdd-GET_PYMT_TXN_DTLS = SELECT fdi.first_name   || ' '   || fdi.cust_last_name AS cust_name                        ,   fdi.caf_no                                                ,   fdi.wl_caf_no                                             ,   fdi.uid_cust_addr                                         ,   NVL(wpi.bank_name,wpa.bank_name)          AS bank_name    ,   NVL (wpi.amount,wpa.amount)               AS amount       ,   NVL(wpi.payment_time,wpa.payment_time)    AS payment_time ,   NVL(wpi.bnk_txn_id,wpa.bnk_txn_id)        AS bnk_txn_id   ,   NVL( wpi.portal_txn_id,wpa.portal_txn_id) AS portal_txn_id,   NVL(wpi.txn_status, wpa.txn_status)       AS txn_status   ,   (SELECT amount FROM ob_wings_plans WHERE plan_id=fdi.WINGS_TARIFF_PLAN_ID   ) AS TARIFF_PLAN_AMOUNT                                            ,   fdi.wings_isd                                                      ,   fdi.wings_ir                                                       ,   TO_CHAR(fdi.date_allotment,'DD-MM-YYYY HH:MI:SS AM') date_allotment,   fdi.service_type AS conn_applied                                   ,   fdi.sel_mob_no   AS service_number    FROM WF_FMS_DATA_INSTANCE FDI JOIN wings_payment_audit wpa      ON fdi.wl_caf_no     = wpa.caf_no and (wpa.txn_time = (select max(txn_time) from wings_payment_audit a where a.caf_no = wpa.caf_no)) LEFT JOIN wings_payment_audit_isdir wpi      ON fdi.wl_caf_no     = wpi.caf_no and (wpa.txn_time = (select max(txn_time) from wings_payment_audit a where a.caf_no = wpi.caf_no))   WHERE (wpa.sessionid    = ? OR wpi.sessionid          = ?)
#GET_PYMT_TXN_DTLS = SELECT     fdi.first_name || ' ' || fdi.cust_last_name AS cust_name,     fdi.caf_no,     fdi.wl_caf_no,     fdi.bill_addr_house_no || ',' || fdi.bill_addr_vill || ',' || fdi.bill_addr_city || ',' || fdi.bill_addr_state || ',' || fdi.bill_addr_district || ',' || fdi.bill_main_locality || ',' || fdi.bill_sub_locality || ',' || fdi.bill_exchange_code || ',' || fdi.bill_addr_pincode AS uid_cust_addr,     nvl(wpi.bank_name, wpa.bank_name) AS bank_name,     nvl(wpi.amount, wpa.amount) AS amount,     nvl(wpi.payment_time, wpa.payment_time) AS payment_time,     nvl(wpi.bnk_txn_id, wpa.bnk_txn_id) AS bnk_txn_id,     nvl(wpi.portal_txn_id, wpa.portal_txn_id) AS portal_txn_id,     nvl(wpi.txn_status, wpa.txn_status) AS txn_status,     (         SELECT             amount         FROM             ob_wings_plans         WHERE             plan_id = fdi.wings_tariff_plan_id     ) AS tariff_plan_amount,         (         SELECT             scheme_amt         FROM             wings_scheme_dtls         WHERE             scheme_id = nvl(fdi.wings_scheme_id, 'WS0')     ) AS scheme_amount,     fdi.wings_isd,     fdi.wings_ir,     TO_CHAR(fdi.date_allotment, 'DD-MM-YYYY HH:MI:SS AM') date_allotment,     fdi.service_type        AS conn_applied,     fdi.sel_mob_no          AS service_number,     fdi.wings_tariff_plan   AS tariff_plan_id,     nvl(fdi.wings_scheme_name, 'N/A') wings_scheme_name,     fdi.email,     fdi.cust_mobile_no FROM     wf_fms_data_instance        fdi     JOIN wings_payment_audit         wpa ON fdi.wl_caf_no = wpa.caf_no                                     AND ( wpa.txn_time = (         SELECT             MAX(txn_time)         FROM             wings_payment_audit a         WHERE             a.caf_no = wpa.caf_no     ) )     LEFT JOIN wings_payment_audit_isdir   wpi ON fdi.wl_caf_no = wpi.caf_no                                                AND ( wpa.txn_time = (         SELECT             MAX(txn_time)         FROM             wings_payment_audit a         WHERE             a.caf_no = wpi.caf_no     ) ) WHERE     ( wpa.sessionid = ?       OR wpi.sessionid = ? )
GET_PYMT_TXN_DTLS = SELECT     fdi.first_name || ' ' || fdi.cust_last_name AS cust_name,     fdi.caf_no,     fdi.wl_caf_no,     fdi.bill_addr_house_no || ',' || fdi.bill_addr_vill || ',' || fdi.bill_addr_city || ',' || fdi.bill_addr_state || ',' || fdi.bill_addr_district || ',' || fdi.bill_main_locality || ',' || fdi.bill_sub_locality || ',' || fdi.bill_exchange_code || ',' || fdi.bill_addr_pincode AS uid_cust_addr,     nvl(wpi.bank_name, wpa.bank_name) AS bank_name,     nvl(wpi.amount, wpa.amount) AS amount,     nvl(wpi.payment_time, wpa.payment_time) AS payment_time,     nvl(wpi.bnk_txn_id, wpa.bnk_txn_id) AS bnk_txn_id,     nvl(wpi.portal_txn_id, wpa.portal_txn_id) AS portal_txn_id,     nvl(wpi.txn_status, wpa.txn_status) AS txn_status,     (         SELECT             amount         FROM             ob_wings_plans         WHERE             plan_id = fdi.wings_tariff_plan_id     ) AS tariff_plan_amount,         (         SELECT             scheme_amt         FROM             wings_scheme_dtls         WHERE             scheme_id = nvl(fdi.wings_scheme_id, 'WS0')     ) AS scheme_amount,     fdi.wings_isd,     fdi.wings_ir,     TO_CHAR(fdi.date_allotment, 'DD-MM-YYYY HH:MI:SS AM') date_allotment,     fdi.service_type        AS conn_applied,     fdi.sel_mob_no          AS service_number,     fdi.wings_tariff_plan   AS tariff_plan_id,     nvl(fdi.wings_scheme_name, 'N/A') wings_scheme_name,     fdi.email,     fdi.cust_mobile_no FROM     wf_fms_data_instance        fdi     JOIN wings_payment_audit         wpa ON fdi.wl_caf_no = wpa.caf_no                                     AND ( wpa.txn_time = (         SELECT             MAX(txn_time)         FROM             wings_payment_audit a         WHERE             a.caf_no = wpa.caf_no     ) )     LEFT JOIN wings_payment_audit_isdir   wpi ON fdi.wl_caf_no = wpi.caf_no                                                AND ( wpa.txn_time = (         SELECT             MAX(txn_time)         FROM             wings_payment_audit a         WHERE             a.caf_no = wpi.caf_no     ) ) WHERE     ( wpa.sessionid = ?       OR wpi.sessionid = ? )

GET_REG_PYMT_TXN_DTLS = SELECT FDW.FIRST_NAME   || ' '   || FDW.CUST_LAST_NAME AS CUST_NAME ,   FDW.CAF_NO,   WPA.BANK_NAME,   WPA.AMOUNT,   WPA.PAYMENT_TIME,   WPA.BNK_TXN_ID,   WPA.PORTAL_TXN_ID,   WPA.TXN_STATUS,   TO_CHAR(FDW.REQ_DATE_TIME,'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT FROM @@DBSCHEMA@@.FMS_DATA_WEB_PORTAL FDW ,   @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT WPA WHERE FDW.CAF_NO = WPA.CAF_NO AND WPA.SESSIONID   = ?
GET_REG_PYMT_TXN_DTLS = SELECT FDW.FIRST_NAME   || ' '   || FDW.CUST_LAST_NAME AS CUST_NAME , (case when FDI.CAF_NO is not null then FDI.CAF_NO else FDW.CAF_NO end ) CAF_NO,   WPA.BANK_NAME,   WPA.AMOUNT,   WPA.PAYMENT_TIME,   WPA.BNK_TXN_ID,   WPA.PORTAL_TXN_ID,   WPA.TXN_STATUS,   FDI.SERVICE_TYPE AS CONN_APPLIED,   FDI.UID_CUST_ADDR,   FDI.SEL_MOB_NO AS SERVICE_NUMBER,   TO_CHAR(FDW.REQ_DATE_TIME,'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT FROM @@DBSCHEMA@@.FMS_DATA_WEB_PORTAL FDW JOIN @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT WPA ON FDW.CAF_NO = WPA.CAF_NO LEFT JOIN @@DBSCHEMA@@.wf_fms_data_instance FDI ON fdi.sessionid    = wpa.sessionid WHERE WPA.SESSIONID = ?
AADHAR_AUDIT_SEQ_QRY = SELECT @@DBSCHEMA@@.AADHAR_AUDIT_SEQ.NEXTVAL FROM DUAL
INSERT_AADHAR_AUDIT_DTLS = INSERT INTO @@DBSCHEMA@@.AADHAAR_AUDIT_DLTS(AUDIT_ID,AUDIT_TYPE,U_ID,USER_TYPE,SSA_CODE,SS_CODE,CIRCLE_ID,CIRCLE_SHORT_CODE,REQ_TIME_CLIENT,REQ_TIME_SERVER,STAG1_PROCESS_TIME,REQ_TIME_SUBMIT_AUA,STAG2_PROCESS_TIME,RESP_AUA_SERVER,STAG3_PROCESS_TIME,REQ_STATUS,REQ_COMMENTS,FLOW_TYPE,AADHAR_NO,AADHAR_SEQ_ID,LOB_TYPE,UID_TOKEN)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
LOAD_WINGS_REGISTERED_USER =SELECT rd.service_type,   rd.caf_no,   rd.first_name   || ' '   || rd.cust_last_name reg_cust_name,   rd.email reg_mail,   rd.cust_mobile_no reg_mob_no,   TO_CHAR(rd.req_date_time,'DD/Mon/YYYY HH:MI:SS') reg_date_time,   pd.bank_name pay_banl_name,   pd.txn_status pay_status,   pd.portal_txn_id pay_txn_id,   pd.txn_time pay_date_time,   CASE     WHEN od.job_user =-1     THEN TO_CHAR(aod.txn_date_time,'DD-Mon-YYYY HH:MI:SS')     ELSE SUBSTR(cust_decl_resp_ts,1,10)       || ' '       || SUBSTR(cust_decl_resp_ts,12,8)   END ekyc_date,   CASE     WHEN od.job_user =            -1     THEN SUBSTR(aod.aadharno,     -4)     ELSE SUBSTR(abd.cust_aadharno,-4)   END aadhar_no,   od.first_name   || ' '   || od.cust_last_name ob_cust_name,   od.sel_mob_no wings_mob_no, od.wings_tariff_plan_id WINGS_PLAN_ID,   od.date_allotment activation_req_date,   od.wings_isd,   od.wings_ir,   od.caf_no application_no,    od.instal_addr_pincode pin_code,   od.inst_exchange_code exchange_code,   od.poi_type, od.poa_type,  COALESCE(od.bb_user_id,'N/A')      AS  service_id,   COALESCE(ad.clarity_remarks,'N/A') AS clarity_remarks,   COALESCE(ad.cust_accnt_num,'N/A')  AS cust_accnt_num,   COALESCE(ad.bill_accnt_num,'N/A')  AS bill_accnt_num,   COALESCE(ad.activation_stat,'N/A') AS activation_stat,   fms_remarks remarks,   ad.activation_date,   ad.wings_pin,   od.circle_code,   rd.ob_status,   CASE     WHEN upper(pd.txn_status) = 'SUCCESS'     AND ob_enable             = 1     THEN 1     WHEN ob_enable = 1     THEN 1     ELSE 0   END ob_enable,   CASE     WHEN NVL(pd.txn_status,'-1') = 'SUCCESS'     AND rd.ob_status             = 1     THEN 0     WHEN NVL(pd.txn_status,'-1') != 'SUCCESS'     AND rd.ob_status              = 1     THEN 1     WHEN NVL(pd.txn_status,'-1') != 'SUCCESS'     AND rd.ob_status             != 1     THEN 2     WHEN NVL(pd.txn_status,'-1') = 'SUCCESS'     AND rd.ob_status            != 1     THEN 3   END action_dtls,   NVL(B.INSTANCE_ID ,  -1) IMG_UPD_FLAG,   NVL(ad.FMS_CA_BA_ID, -1) CA_BA_ID FROM fms_data_web_portal rd LEFT JOIN wings_payment_audit pd ON rd.caf_no = pd.caf_no LEFT JOIN wf_fms_data_instance od ON rd.caf_no = od.wl_caf_no LEFT JOIN aadhar_otp_commns aod ON od.aadhar_seq_id = aod.aadhar_seq_id LEFT JOIN aadhar_comunictons abd ON od.aadhar_seq_id = abd.aadhar_seq_id LEFT JOIN uniserve_caf_ca_ba_vu ad ON ad.uniserve_ca_ba_id = od.caf_no LEFT JOIN ob_caf_imgs_dtls B ON od.INSTANCE_ID       = B.INSTANCE_ID WHERE rd.cust_mobile_no = ?   AND rd.circle_code      = ? AND pd.txn_time         =   (SELECT MAX(txn_time) FROM wings_payment_audit b WHERE pd.caf_no = b.caf_no  and txn_status in ('SUCCESS', 'TRIAL') ) ORDER BY req_date_time DESC
#LOAD_WINGS_REGISTERED_USER =SELECT rd.service_type,   rd.caf_no,   rd.first_name   || ' '   || rd.cust_last_name reg_cust_name,   rd.email reg_mail,   rd.cust_mobile_no reg_mob_no,   TO_CHAR(rd.req_date_time,'DD/Mon/YYYY HH:MI:SS') reg_date_time,   pd.bank_name pay_banl_name,   pd.txn_status pay_status,   pd.portal_txn_id pay_txn_id,   pd.txn_time pay_date_time,   CASE     WHEN od.job_user =-1     THEN TO_CHAR(aod.txn_date_time,'DD-Mon-YYYY HH:MI:SS')     ELSE SUBSTR(cust_decl_resp_ts,1,10)       || ' '       || SUBSTR(cust_decl_resp_ts,12,8)   END ekyc_date,   CASE     WHEN od.job_user =            -1     THEN SUBSTR(aod.aadharno,     -4)     ELSE SUBSTR(abd.cust_aadharno,-4)   END aadhar_no,   od.first_name   || ' '   || od.cust_last_name ob_cust_name,   od.sel_mob_no wings_mob_no, od.wings_tariff_plan_id WINGS_PLAN_ID,  od.date_allotment activation_req_date,   od.wings_isd,   od.wings_ir,   od.caf_no application_no,   od.instal_addr_pincode pin_code,   od.inst_exchange_code exchange_code,   od.poi_type,   od.poa_type,  COALESCE(od.bb_user_id,'N/A')      AS service_id,   COALESCE(ad.clarity_remarks,'N/A') AS clarity_remarks,   COALESCE(ad.cust_accnt_num,'N/A')  AS cust_accnt_num,   COALESCE(ad.bill_accnt_num,'N/A')  AS bill_accnt_num,   COALESCE(ad.activation_stat,'N/A') AS activation_stat,   fms_remarks remarks,   ad.activation_date,   ad.wings_pin,   od.circle_code,   rd.ob_status,   CASE     WHEN upper(pd.txn_status) = 'SUCCESS'     AND ob_enable             = 1     THEN 1     WHEN ob_enable = 1     THEN 1     ELSE 0   END ob_enable,   CASE     WHEN NVL(pd.txn_status,'-1') = 'SUCCESS'     AND rd.ob_status             = 1     THEN 0     WHEN NVL(pd.txn_status,'-1') != 'SUCCESS'     AND rd.ob_status              = 1     THEN 1     WHEN NVL(pd.txn_status,'-1') != 'SUCCESS'     AND rd.ob_status             != 1     THEN 2     WHEN NVL(pd.txn_status,'-1') = 'SUCCESS'     AND rd.ob_status            != 1     THEN 3   END action_dtls,   NVL(B.INSTANCE_ID ,  -1) IMG_UPD_FLAG,   NVL(ad.FMS_CA_BA_ID, -1) CA_BA_ID FROM fms_data_web_portal rd LEFT JOIN wings_payment_audit pd ON rd.caf_no = pd.caf_no AND pd.txn_time         =   (SELECT MAX(txn_time) FROM wings_payment_audit b WHERE pd.caf_no = b.caf_no   and txn_status in ('SUCCESS', 'TRIAL')) LEFT JOIN wf_fms_data_instance od ON rd.caf_no = od.wl_caf_no LEFT JOIN aadhar_otp_commns aod ON od.aadhar_seq_id = aod.aadhar_seq_id LEFT JOIN aadhar_comunictons abd ON od.aadhar_seq_id = abd.aadhar_seq_id LEFT JOIN uniserve_caf_ca_ba_vu ad ON ad.uniserve_ca_ba_id = od.caf_no LEFT JOIN ob_caf_imgs_dtls B ON od.INSTANCE_ID       = B.INSTANCE_ID WHERE rd.cust_mobile_no = ?   AND rd.circle_code      = ? ORDER BY req_date_time DESC
LOAD_FMS_CIRCLES=SELECT PINCODE_STARTS_WITH VALID_PIN, WINGS_ENABLE,  CIRCLE_ID FMS_CIRCLE,   CIRCLE_NAME,   ZONE_ID ZONE_CODE FROM @@DBSCHEMA@@.WINGS_CIRCLE_DETAILS
INSERT_PARTIAL_JOB = INSERT INTO @@DBSCHEMA@@.WINGS_PARTIAL_JOBS (SESSIONID,JOB_DATA,INFO1,INFO2,WINGS_ISD,WINGS_IR) VALUES (?,?,?,?,?,?)
GET_INFO2_DTLS= SELECT INFO1,INFO2,WINGS_ISD,WINGS_IR FROM @@DBSCHEMA@@.WINGS_PARTIAL_JOBS WHERE SESSIONID = ?
GET_PRE_PYMT_DTLS = SELECT SESSIONID,JOB_DATA,DATE_TIME FROM @@DBSCHEMA@@.WINGS_PARTIAL_JOBS WHERE SESSIONID = ?
LOAD_FMS_CUST_DATA = SELECT FDI.CAF_NO, FDI.FILE_PATH,  FDI.WL_CAF_NO,   FDI.ZONE,   FDI.POI_NUMBER,   FDI.CAF_NO,   FDI.FIRST_NAME || ' '   || FDI.CUST_LAST_NAME AS UID_FIRST_NAME,   FDI.UID_LAST_NAME,   FDI.SEL_MOB_NO,   FDI.CUST_TITLE,   FDI.ME_F_H_NAME,   FDI.DOB,   FDI.CUSTOMER_TYPE,   FDI.NATIONALITY,   FDI.AGE,   FDI.CUST_MOBILE_NO, FDI.WINGS_IR, FDI.WINGS_ISD,  TO_CHAR(FDI.DATE_ALLOTMENT,'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT,   FDI.CUST_PREF_COMM_ECAF,   FDI.ALT_MOBILE_NO,   FDI.EMAIL,   FDI.CUST_PRE_TYPE,   FDI.CUST_USAGE_CODE,   FDI.INST_ADDR_HNO,   FDI.INST_ADDR_VILL,   FDI.INST_ADDR_DISTRICT,   FDI.INST_ADDR_CITY,   FDI.INST_ADDR_STATE,   FDI.INST_MAIN_LOCALITY,   FDI.INST_SUB_LOCALITY,   FDI.INST_EXCHANGE_CODE,   FDI.CIRCLE_CODE,   nvl(FDI.WINGS_TARIFF_PLAN_ID, 'WTP1') WINGS_PLAN_ID,   nvl(OWP.AMOUNT, 1297) PLAN_AMOUNT,   WPA.TXN_STATUS AS PYMT_STATUS FROM WF_FMS_DATA_INSTANCE FDI LEFT JOIN WINGS_PAYMENT_AUDIT WPA ON FDI.WL_CAF_NO = WPA.CAF_NO LEFT JOIN OB_WINGS_PLANS OWP ON FDI.WINGS_TARIFF_PLAN_ID = OWP.PLAN_ID  WHERE FDI.CAF_NO = ? AND TXN_TIME     =   (SELECT MAX(TXN_TIME) FROM WINGS_PAYMENT_AUDIT B WHERE WPA.CAF_NO = B.CAF_NO   )  
#LOAD_FMS_CUST_DATA = SELECT FDI.CAF_NO, FDI.FILE_PATH,  FDI.WL_CAF_NO,   FDI.ZONE,   FDI.POI_NUMBER,   FDI.CAF_NO,   FDI.FIRST_NAME || ' '   || FDI.CUST_LAST_NAME AS UID_FIRST_NAME,   FDI.UID_LAST_NAME,   FDI.SEL_MOB_NO,   FDI.CUST_TITLE,   FDI.ME_F_H_NAME,   FDI.DOB,   FDI.CUSTOMER_TYPE,   FDI.NATIONALITY,   FDI.AGE,   FDI.CUST_MOBILE_NO, FDI.WINGS_IR, FDI.WINGS_ISD,    TO_CHAR(FDI.DATE_ALLOTMENT,'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT,   FDI.CUST_PREF_COMM_ECAF,   FDI.ALT_MOBILE_NO,   FDI.EMAIL,   FDI.CUST_PRE_TYPE,   FDI.CUST_USAGE_CODE,   FDI.INST_ADDR_HNO,   FDI.INST_ADDR_VILL,   FDI.INST_ADDR_DISTRICT,   FDI.INST_ADDR_CITY,   FDI.INST_ADDR_STATE,   FDI.INST_MAIN_LOCALITY,   FDI.INST_SUB_LOCALITY,   FDI.INST_EXCHANGE_CODE,   FDI.CIRCLE_CODE,   nvl(FDI.WINGS_TARIFF_PLAN_ID, 'WTP1') WINGS_PLAN_ID,   nvl(OWP.AMOUNT, 1297) PLAN_AMOUNT,   WPA.TXN_STATUS AS PYMT_STATUS FROM WF_FMS_DATA_INSTANCE FDI LEFT JOIN WINGS_PAYMENT_AUDIT WPA ON FDI.WL_CAF_NO = WPA.CAF_NO AND TXN_TIME     =   (SELECT MAX(TXN_TIME) FROM WINGS_PAYMENT_AUDIT B WHERE WPA.CAF_NO = B.CAF_NO   ) LEFT JOIN OB_WINGS_PLANS OWP ON FDI.WINGS_TARIFF_PLAN_ID = OWP.PLAN_ID WHERE FDI.CAF_NO = ?

WINGS_OTP_AUDIT = INSERT INTO @@DBSCHEMA@@.WINGS_OTP_AUDIT (ZONE_CODE, CIRCLE, MOBILE_NO, OTP, STATUS, ACKID, COMMENTS) VALUES (?,?,?,?,?,?,?)
FMS_DISRICT_LIST = SELECT DISTINCT DISTRICT DD_CODE,   DISTRICT DD_VALUE FROM @@DBSCHEMA@@.MAIN_SUB_LOC_$ZONE_SH$ WHERE ZONE      = ? AND CIRCLE_NAME = ? AND CIRCLE = ? ORDER BY DISTRICT ASC
GET_PYMT_TXN_DTLS_EKYC=SELECT FDI.FIRST_NAME   || ' '   || FDI.CUST_LAST_NAME AS CUST_NAME ,   FDI.CAF_NO,   WPA.BANK_NAME,   WPA.AMOUNT,   WPA.PAYMENT_TIME,   WPA.BNK_TXN_ID,   WPA.PORTAL_TXN_ID,   WPA.TXN_STATUS,   FDI.SEL_MOB_NO AS SERVICE_NUMBER   FROM @@DBSCHEMA@@.wf_fms_data_instance FDI JOIN @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT WPA ON FDI.WL_CAF_NO = WPA.CAF_NO WHERE WPA.SESSIONID = ?
CHECK_PYMT_STATUS = SELECT count(1) FROM @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT WHERE TXN_STATUS ='SUCCESS' AND CAF_NO = ? 
UPDATE_WL_SESSIONID = UPDATE @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE SET WL_CAF_NO= ? , SESSIONID= ? WHERE CAF_NO =?
CHECK_USER_CIRCLE=SELECT COUNT(1) FROM @@DBSCHEMA@@.WINGS_CIRCLE_DETAILS WHERE CIRCLE_ID = ? AND WINGS_ENABLE =? AND ZONE_ID = ?
LOAD_CUST_TOK_DATA= SELECT rd.service_type,   rd.caf_no,   RD.FIRST_NAME   || ' '   || RD.CUST_LAST_NAME REG_CUST_NAME,   RD.EMAIL REG_MAIL,   RD.CUST_MOBILE_NO REG_MOB_NO,   TO_CHAR(rd.req_date_time, 'DD/Mon/YYYY HH:MI:SS') REG_DATE_TIME,   pd.bank_name PAY_BANL_NAME,   PD.TXN_STATUS PAY_STATUS,   PD.PORTAL_TXN_ID PAY_TXN_ID,   PD.TXN_TIME PAY_DATE_TIME,   CASE     WHEN OD.JOB_USER = -1     THEN TO_CHAR(AOD.TXN_DATE_TIME, 'DD-Mon-YYYY HH:MI:SS')     ELSE SUBSTR(CUST_DECL_RESP_TS, 1, 10)       || ' '       || SUBSTR(CUST_DECL_RESP_TS, 12, 8)   END EKYC_DATE,   CASE     WHEN OD.JOB_USER =             -1     THEN SUBSTR(aod.aadharno,      -4)     ELSE SUBSTR(ABD.CUST_AADHARNO, -4)   END AADHAR_NO,   OD.FIRST_NAME   || ' '   || OD.CUST_LAST_NAME OB_CUST_NAME,   od.sel_mob_no WINGS_MOB_NO,   od.date_allotment ACTIVATION_REQ_DATE,   OD.CAF_NO APPLICATION_NO,   od.instal_addr_pincode pin_code,   od.inst_exchange_code exchange_code,   od.poi_type,   od.poa_type,   COALESCE(od.bb_user_id,'N/A')      AS service_id,   COALESCE(ad.clarity_remarks,'N/A') AS clarity_remarks,   COALESCE(ad.cust_accnt_num,'N/A')  AS cust_accnt_num,   COALESCE(ad.bill_accnt_num,'N/A')  AS bill_accnt_num,   COALESCE(ad.activation_stat,'N/A') AS activation_stat,   FMS_REMARKS REMARKS,   AD.ACTIVATION_DATE,   AD.ACTIVATION_STAT,   AD.WINGS_PIN,   OD.CIRCLE_CODE,   OD.WINGS_ISD,   OD.WINGS_IR,   rd.ob_status,   CASE     WHEN upper(pd.txn_status) = 'SUCCESS'     AND ob_enable             = 1     THEN 1     WHEN ob_enable = 1     THEN 1     ELSE 0   END ob_enable,   CASE     WHEN NVL(PD.TXN_STATUS, '-1') = 'SUCCESS'     AND RD.OB_STATUS              = 1     THEN 0     WHEN NVL(PD.TXN_STATUS, '-1') != 'SUCCESS'     AND RD.OB_STATUS               = 1     THEN 1     WHEN NVL(PD.TXN_STATUS, '-1') != 'SUCCESS'     AND RD.OB_STATUS              != 1     THEN 2     WHEN NVL(PD.TXN_STATUS, '-1') = 'SUCCESS'     AND RD.OB_STATUS             != 1     THEN 3   END ACTION_DTLS   NVL(B.INSTANCE_ID ,  -1) IMG_UPD_FLAG,   NVL(ad.FMS_CA_BA_ID, -1) CA_BA_ID FROM FMS_DATA_WEB_PORTAL RD LEFT JOIN WINGS_PAYMENT_AUDIT PD ON RD.CAF_NO    = PD.CAF_NO AND PD.txn_time =   (SELECT MAX(iq.txn_time)   FROM wings_payment_audit iq   WHERE PD.caf_no = iq.caf_no   ) LEFT JOIN wf_fms_data_instance OD ON RD.caf_no = OD.wl_caf_no LEFT JOIN aadhar_otp_commns AOD ON OD.AADHAR_SEQ_ID = AOD. AADHAR_SEQ_ID LEFT JOIN AADHAR_COMUNICTONS ABD ON OD.AADHAR_SEQ_ID = ABD. AADHAR_SEQ_ID LEFT JOIN uniserve_caf_ca_ba_vu AD ON AD.uniserve_ca_ba_id = OD.CAF_NO LEFT JOIN ob_caf_imgs_dtls B ON od.INSTANCE_ID       = B.INSTANCE_ID WHERE @@SECONDRY_STRING@@ ORDER BY req_date_time DESC
#LOAD_CUST_TOK_DATA= SELECT rd.service_type,   rd.caf_no,   RD.FIRST_NAME   || ' '   || RD.CUST_LAST_NAME REG_CUST_NAME,   RD.EMAIL REG_MAIL,   RD.CUST_MOBILE_NO REG_MOB_NO,   TO_CHAR(rd.req_date_time, 'DD/Mon/YYYY HH:MI:SS') REG_DATE_TIME,   pd.bank_name PAY_BANL_NAME,   PD.TXN_STATUS PAY_STATUS,   PD.PORTAL_TXN_ID PAY_TXN_ID,   PD.TXN_TIME PAY_DATE_TIME,   CASE     WHEN OD.JOB_USER = -1     THEN TO_CHAR(AOD.TXN_DATE_TIME, 'DD-Mon-YYYY HH:MI:SS')     ELSE SUBSTR(CUST_DECL_RESP_TS, 1, 10)       || ' '       || SUBSTR(CUST_DECL_RESP_TS, 12, 8)   END EKYC_DATE,   CASE     WHEN OD.JOB_USER =             -1     THEN SUBSTR(aod.aadharno,      -4)     ELSE SUBSTR(ABD.CUST_AADHARNO, -4)   END AADHAR_NO,   OD.FIRST_NAME   || ' '   || OD.CUST_LAST_NAME OB_CUST_NAME,   od.sel_mob_no WINGS_MOB_NO,   od.date_allotment ACTIVATION_REQ_DATE,   OD.CAF_NO APPLICATION_NO,   od.instal_addr_pincode pin_code,   od.inst_exchange_code exchange_code,   od.poi_type,   od.poa_type,   COALESCE(od.bb_user_id,'N/A')      AS service_id,   COALESCE(ad.clarity_remarks,'N/A') AS clarity_remarks,   COALESCE(ad.cust_accnt_num,'N/A')  AS cust_accnt_num,   COALESCE(ad.bill_accnt_num,'N/A')  AS bill_accnt_num,   COALESCE(ad.activation_stat,'N/A') AS activation_stat,   FMS_REMARKS REMARKS,   AD.ACTIVATION_DATE,   AD.ACTIVATION_STAT,   AD.WINGS_PIN,   OD.CIRCLE_CODE,   OD.WINGS_ISD,   OD.WINGS_IR,   rd.ob_status,   CASE     WHEN upper(pd.txn_status) = 'SUCCESS'     AND ob_enable             = 1     THEN 1     WHEN ob_enable = 1     THEN 1     ELSE 0   END ob_enable,   CASE     WHEN NVL(PD.TXN_STATUS, '-1') = 'SUCCESS'     AND RD.OB_STATUS              = 1     THEN 0     WHEN NVL(PD.TXN_STATUS, '-1') != 'SUCCESS'     AND RD.OB_STATUS               = 1     THEN 1     WHEN NVL(PD.TXN_STATUS, '-1') != 'SUCCESS'     AND RD.OB_STATUS              != 1     THEN 2     WHEN NVL(PD.TXN_STATUS, '-1') = 'SUCCESS'     AND RD.OB_STATUS             != 1     THEN 3   END ACTION_DTLS,   NVL(B.INSTANCE_ID ,  -1) IMG_UPD_FLAG,   NVL(ad.FMS_CA_BA_ID, -1) CA_BA_ID FROM FMS_DATA_WEB_PORTAL RD LEFT JOIN WINGS_PAYMENT_AUDIT PD ON RD.CAF_NO = PD.CAF_NO LEFT JOIN wf_fms_data_instance OD ON RD.caf_no = OD.wl_caf_no LEFT JOIN aadhar_otp_commns AOD ON OD.AADHAR_SEQ_ID = AOD. AADHAR_SEQ_ID LEFT JOIN AADHAR_COMUNICTONS ABD ON OD.AADHAR_SEQ_ID = ABD. AADHAR_SEQ_ID LEFT JOIN uniserve_caf_ca_ba_vu AD ON AD.uniserve_ca_ba_id = OD.CAF_NO LEFT JOIN ob_caf_imgs_dtls B ON od.INSTANCE_ID       = B.INSTANCE_ID WHERE @@SECONDRY_STRING@@ ORDER BY req_date_time DESC
FETCH_PAY_LINL_REQ_DTLS= SELECT FDP.CUST_MOBILE_NO,FDP.EMAIL,FDI.CAF_NO,FDP.CAF_NO WL_CAF_NO FROM @@DBSCHEMA@@.FMS_DATA_WEB_PORTAL FDP LEFT JOIN @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE FDI  ON FDI.WL_CAF_NO=FDP.CAF_NO WHERE   FDP.CAF_NO=? 
WINGS_LINK_AUDIT = INSERT INTO @@DBSCHEMA@@.WINGS_LINK_AUDIT (ACKID, CAF_NO, EMAIL, MOBILE_NO,  LINK_TYPE, LINK) VALUES (?,?,?,?,?,?)
LOAD_FMS_CIRCLE_CODE=SELECT DISTINCT CIRCLE_CODE FMS_CIRCLE FROM @@DBSCHEMA@@.WINGS_CIRCLE_DETAILS WHERE CIRCLE_ID = ? 
LOAD_WINGS_COMPLAINTS=SELECT COMPLAINT_ID,  COMPLAINT_NAME ,   TO_EMAIL,   SUBJECT  FROM @@DBSCHEMA@@.WINGS_COMPLAINT_TYPES
WINGS_COMPLAINT_AUDIT= INSERT INTO @@DBSCHEMA@@.WINGS_COMPLAINT_AUDIT (ACKID,FROM_EMAIL,TO_EMAIL,COMPLAINT_ID,STATUS,MAIL_CONTENT) VALUES (?,?,?,?,?,?)
GET_WINGS_PLANS=SELECT AMOUNT, PLAN_NAME,IS_DEFAULT, PLAN_ID FROM @@DBSCHEMA@@.OB_WINGS_PLANS WHERE PLAN_TYPE = 'INDV' AND PLAN_ID !='WTP5'
GET_TARIFF_PLAN_AMOUNT = SELECT AMOUNT  FROM @@DBSCHEMA@@.OB_WINGS_PLANS WHERE PLAN_ID  = ? AND PLAN_TYPE = 'INDV'

WINGS_PAYMENT_AUDIT_ISDIR = INSERT INTO @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT_ISDIR (CAF_NO, SESSIONID, BNK_TXN_ID, AMOUNT, SERVICE_NAME, PORTAL_TXN_ID, VENDOR_TXN_ID, TXN_STATUS, ERROR_CODE, ERROR_MSG, PAYMENT_TIME, MOBILE_NO ,REQ_TYPE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)
UPDATE_ISDIR_PAYMENT_AUDIT = UPDATE @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT_ISDIR SET BNK_TXN_ID =?,   AMOUNT       =?,   SERVICE_NAME =?,   PORTAL_TXN_ID=?,   VENDOR_TXN_ID=?,   TXN_STATUS   =?,   ERROR_CODE   =?,   ERROR_MSG    =?,   PAYMENT_TIME =?,   BANK_NAME  =? WHERE SESSIONID=?
GET_PYMT_TXN_DTLS_ISDIR = SELECT FDI.FIRST_NAME   || ' '   || FDI.CUST_LAST_NAME AS CUST_NAME ,   FDI.CAF_NO,   FDI.WL_CAF_NO,   FDI.UID_CUST_ADDR,   WPA.BANK_NAME,   WPA.AMOUNT,   WPA.PAYMENT_TIME,   WPA.BNK_TXN_ID,   WPA.PORTAL_TXN_ID,   WPA.TXN_STATUS,   TO_CHAR(FDI.DATE_ALLOTMENT,'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT,   FDI.SERVICE_TYPE   AS CONN_APPLIED,   FDI.SEL_MOB_NO     AS SERVICE_NUMBER  FROM @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE FDI ,   @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT_ISDIR WPA WHERE FDI.SESSIONID = WPA.SESSIONID AND UPPER(WPA.TXN_STATUS) = 'SUCCESS' AND  WPA.SESSIONID   =  ?
#UPDATE_ISDIR_DATA_INSTANCE = UPDATE @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE SET WINGS_ISD= ? , WINGS_IR= ? WHERE CAF_NO =?
UPDATE_WL_SID_ISD = UPDATE @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE SET WL_CAF_NO= ? , SESSIONID= ? WINGS_ISD= ? , WINGS_IR= ?, , WINGS_ISD_IR_DT = CURRENT_TIMESTAMP WHERE CAF_NO =?
UPDATE_ISD_IR = UPDATE @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE SET WINGS_ISD= ? , WINGS_IR= ?, WINGS_ISD_IR_DT = CURRENT_TIMESTAMP  WHERE CAF_NO =?
#GET_WINGS_CAF_DETAILS=SELECT b.instance_id,   dwp.zone_code,   dwp.first_name                       AS name,   NVL(b.sel_mob_no,dwp.cust_mobile_no) AS mobile,   dwp.email,   TO_CHAR(NVL(b.date_allotment,dwp.req_date_time),'dd-MM-yyyy hh:mi:ss AM') register_date,   NVL(dwp.caf_no,dwp.caf_no) caf_no,   dwp.circle_code,   wpa.sessionid,   wpa.txn_status,   CASE     WHEN ( upper(wpa.txn_status) = 'SUCCESS' )     THEN 'Success'     ELSE 'Pending'   END status,   CASE     WHEN upper(wpa.txn_status) = 'SUCCESS'     AND ob_enable              = 1     THEN 1     WHEN ob_enable = 1     THEN 1     ELSE 0   END ob_enable,   ob_status,   CASE     WHEN ob_status = 0     THEN 'Onboard Pending'     ELSE DECODE(a.activation_stat,'N','PIN Generation in progress','Y','PIN Generated Successfully','P','Pending at NGN due to some Error' ,'Activation Pending')   END "ActivationStatus",   a.wings_pin "WINGSPIN",   wpn.wings_mob_no WINGS_PRE_NO,   wpa.tariff_plan_id,   wpn.wings_pin WINGS_PRE_PIN FROM fms_data_web_portal dwp LEFT JOIN  wings_payment_audit wpa ON dwp.caf_no = wpa.caf_no LEFT JOIN wf_fms_data_instance b ON dwp.caf_no = b.wl_caf_no LEFT JOIN uniserve_caf_ca_ba_vu a ON a.uniserve_ca_ba_id = b.instance_id LEFT JOIN WINGS_NO_PRE_ACT_PIN WPN ON WPN.CAF_NO    = DWP.CAF_NO WHERE dwp.CAF_NO =? AND wpa.txn_time =   (SELECT MAX(iq.txn_time)   FROM wings_payment_audit iq   WHERE wpa.caf_no = iq.caf_no   )
GET_WINGS_CAF_DETAILS=SELECT b.instance_id,   dwp.zone_code,   dwp.first_name                       AS name,   NVL(b.sel_mob_no,dwp.cust_mobile_no) AS mobile,   dwp.email,   TO_CHAR(NVL(b.date_allotment,dwp.req_date_time),'dd-MM-yyyy hh:mi:ss AM') register_date,   NVL(dwp.caf_no,dwp.caf_no) caf_no,   dwp.circle_code,   wpa.sessionid,   wpa.txn_status,   CASE     WHEN ( upper(wpa.txn_status) = 'SUCCESS' )     THEN 'Success'     ELSE 'Pending'   END status,   CASE     WHEN upper(wpa.txn_status) = 'SUCCESS'     AND ob_enable              = 1     THEN 1     WHEN ob_enable = 1     THEN 1     ELSE 0   END ob_enable,   ob_status,   CASE     WHEN ob_status = 0     THEN 'Onboard Pending'     ELSE DECODE(a.activation_stat,'N','PIN Generation in progress','Y','PIN Generated Successfully','P','Pending at NGN due to some Error' ,'Activation Pending')   END "ActivationStatus",   a.wings_pin "WINGSPIN",   wpn.wings_mob_no WINGS_PRE_NO,   wpa.tariff_plan_id,   wpn.wings_pin WINGS_PRE_PIN FROM fms_data_web_portal dwp LEFT JOIN  wings_payment_audit wpa ON dwp.caf_no = wpa.caf_no AND wpa.txn_time =   (SELECT MAX(iq.txn_time)   FROM wings_payment_audit iq   WHERE wpa.caf_no = iq.caf_no   ) LEFT JOIN wf_fms_data_instance b ON dwp.caf_no = b.wl_caf_no LEFT JOIN uniserve_caf_ca_ba_vu a ON a.uniserve_ca_ba_id = b.instance_id LEFT JOIN WINGS_NO_PRE_ACT_PIN WPN ON WPN.CAF_NO    = DWP.CAF_NO WHERE dwp.CAF_NO =?
PROC_PAYMENT_AUDIT_DTLS= @@DBSCHEMA@@.PROC_PAYMENT_AUDIT_DTLS(?,?)
FMS_LL_SEQ_NO = SELECT @@DBSCHEMA@@.SDKYC_ID.NEXTVAL FROM DUAL
CHECK_LL_USER_COUNT = SELECT SDKYC_ID FROM @@DBSCHEMA@@.OB_SELF_DKYC_AUDIT WHERE MOBILENO= ? AND EMAILID = ? AND SDKYC_ID NOT IN (SELECT SDKYC_ID FROM WF_FMS_DATA_INSTANCE WHERE JOB_TYPE = ? AND JOB_SOURCE = ? AND  CUST_MOBILE_NO = ? AND EMAIL = ?)
SELF_LL_DKYC_AUDIT = INSERT INTO @@DBSCHEMA@@.OB_SELF_DKYC_AUDIT (SDKYC_ID, MOBILENO, EMAILID, CIRCLE) VALUES (?, ?, ?, ?)
FETCH_CIRCLE_LIST=SELECT CIRCLE_CODE,CIRCLE_NAME, b.zone_code FROM CIRCLE_DETAILS a join zone_master b on a.zone_id = b.zone_id order by circle_name
#TRIAL
FETCH_PLAN_AMT=select plan_id ,plan_name, amount from @@DBSCHEMA@@.ob_wings_plans where plan_type='TRIAL'
UPDATE_FMS_TRIAL_DATA = UPDATE @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE set WINGS_TARIFF_PLAN_ID = ?,WINGS_TARIFF_PLAN = ?, TARIFF_ID_NAME = ?, TARIFF_ID_VALUE = ?, WINGS_ISD = ?, WINGS_IR = ?, sessionid=? ,WINGS_SCHEME_ID = ?,WINGS_SCHEME_NAME =? where caf_no= ?
GET_INFO2_TRIAL_DTLS= SELECT INFO1,INFO2,WINGS_ISD,WINGS_IR FROM @@DBSCHEMA@@.WINGS_TRIAL_PARTIAL_JOBS WHERE SESSIONID = ?
UPDATE_TRIAL_PAYMENT_AUDIT = UPDATE @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT SET BNK_TXN_ID =?,   AMOUNT       =?,   SERVICE_NAME =?,   PORTAL_TXN_ID=?,   VENDOR_TXN_ID=?,   TXN_STATUS   =?,   ERROR_CODE   =?,   ERROR_MSG    =?,   PAYMENT_TIME =?,   BANK_NAME  =? WHERE SESSIONID=?
INSERT_TRIAL_PARTIAL_JOB=INSERT INTO @@DBSCHEMA@@.WINGS_TRIAL_PARTIAL_JOBS (SESSIONID,JOB_DATA,INFO1,INFO2,WINGS_ISD,WINGS_IR) VALUES (?,?,?,?,?,?)
FETCH_CAFNO_FOR_RETRY=select caf_no   from wf_fms_data_instance where wl_caf_no=(select caf_no from wings_payment_audit where sessionid=?)
FETCH_EMP_DATA=SELECT MOBILENO,CIRCLE, ZONE ,HRMSNO, UTILIZE FROM @@DBSCHEMA@@.WINGS_BSNL_EMP_DATA WHERE HRMSNO = ?
UPDATE_BSNL_EMP_REF_UTIL= UPDATE @@DBSCHEMA@@.WINGS_BSNL_EMP_DATA SET UTILIZE=1, CONSUME_DT = CURRENT_TIMESTAMP WHERE HRMSNO=? AND UTILIZE=0
GET_CAF_PAY_TXN_STATUS = SELECT COUNT(1) FROM @@DBSCHEMA@@.WINGS_PAYMENT_AUDIT WHERE CAF_NO=(SELECT WL_CAF_NO FROM @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE WHERE CAF_NO= ?) AND TXN_STATUS ='SUCCESS'

LOAD_RENEWAL_CSC_CUST_DATA = SELECT FDI.WL_CAF_NO AS CAF_NO,     FDI.ZONE,     FDI.FIRST_NAME   || ' '   || FDI.CUST_LAST_NAME AS UID_FIRST_NAME,   FDI.SEL_MOB_NO,     FDI.CUST_MOBILE_NO,   FDI.WINGS_IR,   FDI.WINGS_ISD,   TO_CHAR(FDI.DATE_ALLOTMENT,'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT,   FDI.CUST_PREF_COMM_ECAF,   FDI.ALT_MOBILE_NO,   FDI.EMAIL,   FDI.CUST_USAGE_CODE,   FDI.INST_ADDR_HNO,   FDI.INST_ADDR_VILL,   FDI.INST_ADDR_DISTRICT,   FDI.INST_ADDR_CITY,   FDI.INST_ADDR_STATE,   FDI.INST_MAIN_LOCALITY,   FDI.INST_SUB_LOCALITY,   FDI.INST_EXCHANGE_CODE,   FDI.CIRCLE_CODE  FROM WINGS_CDR_TRIAL_JOBS FDI WHERE FDI.WL_CAF_NO   = ? AND FDI.RENEWAL_STATUS=0
WINGS_CDR_PAYMENT_AUDIT = INSERT INTO @@DBSCHEMA@@.WINGS_CDR_PAYMENT_AUDIT (CAF_NO, SESSIONID, BNK_TXN_ID, AMOUNT, SERVICE_NAME, PORTAL_TXN_ID, VENDOR_TXN_ID, TXN_STATUS, ERROR_CODE, ERROR_MSG, PAYMENT_TIME, MOBILE_NO,TARIFF_PLAN_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)
UPDATE_WINGS_CDR_PAYMENT_AUDIT = UPDATE @@DBSCHEMA@@.WINGS_CDR_PAYMENT_AUDIT SET BNK_TXN_ID =?,   AMOUNT       =?,   SERVICE_NAME =?,   PORTAL_TXN_ID=?,   VENDOR_TXN_ID=?,   TXN_STATUS   =?,   ERROR_CODE   =?,   ERROR_MSG    =?,   PAYMENT_TIME =?,   BANK_NAME  =? WHERE SESSIONID=?
WINGS_CDR_TXN_DATA= SELECT     FDI.FIRST_NAME || ' '  || FDI.CUST_LAST_NAME AS CUST_NAME, FDI.WL_CAF_NO AS CAF_NO,  FDI.WL_CAF_NO, WPA.BANK_NAME  AS BANK_NAME,WPA.AMOUNT AS AMOUNT, FDI.PROCESSED_DATE   AS PAYMENT_TIME, WPA.BNK_TXN_ID       AS BNK_TXN_ID,     WPA.PORTAL_TXN_ID    AS PORTAL_TXN_ID,     WPA.TXN_STATUS       AS TXN_STATUS,     (         SELECT             AMOUNT         FROM             OB_WINGS_PLANS         WHERE             PLAN_ID = FDI.WINGS_TARIFF_PLAN_ID     ) AS TARIFF_PLAN_AMOUNT, (SELECT scheme_amt     FROM wings_scheme_dtls    WHERE scheme_id = fdi.WINGS_SCHEME_ID  ) AS SCHEME_PLAN_AMOUNT    ,    FDI.WINGS_ISD,     FDI.WINGS_IR,     TO_CHAR(FDI.DATE_ALLOTMENT, 'DD-MM-YYYY HH:MI:SS AM') DATE_ALLOTMENT,     FDI.SERVICE_TYPE     AS CONN_APPLIED,     FDI.SEL_MOB_NO       AS SERVICE_NUMBER FROM     WINGS_CDR_TRIAL_JOBS FDI     JOIN WINGS_CDR_PAYMENT_AUDIT   WPA ON FDI.WL_CAF_NO = WPA.CAF_NO WHERE     WPA.SESSIONID = ?
INSERT_CDR_PARTIAL_JOB=INSERT INTO @@DBSCHEMA@@.WINGS_CDR_PARTIAL_JOBS (SESSIONID,JOB_DATA,INFO1,INFO2,WINGS_ISD,WINGS_IR) VALUES (?,?,?,?,?,?)
GET_CDR_DTLS= SELECT INFO1,INFO2,WINGS_ISD,WINGS_IR FROM @@DBSCHEMA@@.WINGS_CDR_PARTIAL_JOBS WHERE SESSIONID = ?
UPDATE_CDR_RENEWAL_DATA = UPDATE @@DBSCHEMA@@.WINGS_CDR_TRIAL_JOBS set WINGS_TARIFF_PLAN_ID = ?,WINGS_TARIFF_PLAN = ?, TARIFF_ID_NAME = ?, TARIFF_ID_VALUE = ?, WINGS_ISD = ?, WINGS_IR = ?, sessionid=?,RENEWAL_STATUS=?,PROCESSED_DATE=?,FILE_PATH=?,WINGS_SCHEME_ID = ?,WINGS_SCHEME_NAME =? where caf_no= ?
LOAD_WINGS_SCHEME_PLANS = SELECT SCHEME_ID, SCHEME_NAME, SCHEME_AMT FROM @@DBSCHEMA@@.WINGS_SCHEME_DTLS ORDER BY SCHEME_ORDER
WINGS_SCHEME_PYMT_AUDIT = INSERT INTO @@DBSCHEMA@@.WINGS_SCHEME_PAYMENT_AUDIT (CAF_NO, SESSIONID, BNK_TXN_ID, AMOUNT, SERVICE_NAME, PORTAL_TXN_ID, VENDOR_TXN_ID, TXN_STATUS, ERROR_CODE, ERROR_MSG, PAYMENT_TIME, MOBILE_NO ,REQ_TYPE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)
GET_SCHEME_PLAN_AMOUNT = SELECT SCHEME_AMT AS AMOUNT  FROM @@DBSCHEMA@@.WINGS_SCHEME_DTLS WHERE SCHEME_ID  = ? AND SCHEME_TYPE = 'INDV'
UPDATE_SCHEME_PAYMENT_AUDIT = UPDATE @@DBSCHEMA@@.WINGS_SCHEME_PAYMENT_AUDIT SET BNK_TXN_ID =?,   AMOUNT       =?,   SERVICE_NAME =?,   PORTAL_TXN_ID=?,   VENDOR_TXN_ID=?,   TXN_STATUS   =?,   ERROR_CODE   =?,   ERROR_MSG    =?,   PAYMENT_TIME =?,   BANK_NAME  =? WHERE SESSIONID=?
GET_RMN_STATUS = SELECT COUNT(1) AS COUNT FROM @@DBSCHEMA@@.FMS_DATA_WEB_PORTAL WHERE UPPER(SERVICE_TYPE)='WINGS' AND OB_STATUS=1 AND CUST_MOBILE_NO= ?
#DISSCONNECTION
DISCON_DKYC_CHECK = SELECT COUNT(1) COUNT FROM @@DBSCHEMA@@.WF_FMS_DATA_INSTANCE WHERE WINGS_TARIFF_PLAN_ID='WTPD' AND CAF_NO=?
DISCON_RENEWAL_CHECK = SELECT COUNT(1) COUNT FROM @@DBSCHEMA@@.WINGS_CDR_TRIAL_JOBS WHERE WINGS_TARIFF_PLAN_ID='WTPD' AND CAF_NO=?
